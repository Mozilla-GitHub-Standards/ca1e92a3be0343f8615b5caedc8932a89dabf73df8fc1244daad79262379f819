{% extends "layout.html" %}

{% import "macros/platforms.html" as platforms %}
{% import "macros/oses.html" as oses %}
{% import "macros/statuses.html" as statuses %}
{% import "macros/forms.html" as forms %}

{% block title %}
    {% trans "Submit plugin info" %}
{% endblock %}

{% block content %}
    {% if saved %}
        <p>{% trans "Your plugin data submission has been accepted, thank you!" %}</p>
        <p><a href="{{base_url}}">{% trans "Return to the home page?" %}</a></p>
    {% else %}

        <form class="contribute" action="{{base_url}}plugins/submit" method="post">
            {% set data, errors as form_data, form_errors %}

            {{ forms.hidden(data, errors, 'detected_version', _GET.version) }}
            
            {{ forms.fieldset('Plugin details'|trans, 'plugin_details') }}
        
                <li><p>{% blocktrans %}
                    This form will submit details detected about this plugin and your browser,
                    along with the following fields that you may modify to suggest
                    corrections.
                {% endblocktrans %}</p></li>

                {{ forms.dropdown(data, errors, 'status', 'Status'|trans, status_choices) }}
                {{ forms.input(data, errors, 'text', 'vulnerability_url', 'Vulnerability URL'|trans) }}
                {{ forms.textarea(data, errors, 'vulnerability_description', 'Vulnerability description'|trans) }}
                {{ forms.input(data, errors, 'text', 'vendor', 'Vendor'|trans) }}
                {{ forms.input(data, errors, 'text', 'name', 'Name'|trans) }}
                {{ forms.input(data, errors, 'text', 'version', 'Version'|trans) }}
                {{ forms.textarea(data, errors, 'description', 'Description'|trans) }}
                {{ forms.textarea(data, errors, 'comments', 'Comments'|trans) }}

                {{ forms.captcha(data, errors, 'captcha', 'Captcha'|trans) }}
                
                {{ forms.submit('submit', '', 'Submit'|trans) }}

                <li>
                <p>{% trans "Also submitting the following additional information:" %}</p>
                    <dl>
                        {% if is_logged_in %}
                            <dt>screen_name</dt>
                            <dd>
                                {{ authprofile.screen_name | e}}
                                {{ forms.hidden(data, errors, 'screen_name', authprofile.screen_name) }}
                            </dd>
                        {% endif %}
                        {% for name in 'pfs_id filename detected_version detection_type appID appRelease appVersion clientOS chromeLocale mimetypes' | explode %}
                            <dt>{{ name | e }}</dt>
                            <dd>
                                {{ data[name] | e }}
                                {{ forms.hidden(data, errors, name) }}
                            </dd>
                        {% endfor %}
                    </dl>
                </li>
                
            {{ forms.endfieldset() }}

        </form>

    {% endif %}

{% endblock %}
